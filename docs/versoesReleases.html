<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Versões e releases | O Zen do R</title>
  <meta name="description" content="Um livro de programação para não-programadores" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Versões e releases | O Zen do R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Um livro de programação para não-programadores" />
  <meta name="github-repo" content="curso-r/zen-do-r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Versões e releases | O Zen do R" />
  
  <meta name="twitter:description" content="Um livro de programação para não-programadores" />
  

<meta name="author" content="C. Lente" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="testes.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="zen-do-r.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">O Zen do R</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bem-vindo</a></li>
<li class="chapter" data-level="1" data-path="introducao.html"><a href="introducao.html"><i class="fa fa-check"></i><b>1</b> Introdução</a><ul>
<li class="chapter" data-level="1.1" data-path="introducao.html"><a href="introducao.html#sobre-o-livro"><i class="fa fa-check"></i><b>1.1</b> Sobre o livro</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introducao.html"><a href="introducao.html#o-que-você-vai-aprender"><i class="fa fa-check"></i><b>1.1.1</b> O que você vai aprender</a></li>
<li class="chapter" data-level="1.1.2" data-path="introducao.html"><a href="introducao.html#o-que-você-não-vai-aprender"><i class="fa fa-check"></i><b>1.1.2</b> O que você não vai aprender</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introducao.html"><a href="introducao.html#pré-requisitos"><i class="fa fa-check"></i><b>1.2</b> Pré-requisitos</a></li>
<li class="chapter" data-level="1.3" data-path="introducao.html"><a href="introducao.html#principais-referências"><i class="fa fa-check"></i><b>1.3</b> Principais referências</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rdata-rhistory.html"><a href="rdata-rhistory.html"><i class="fa fa-check"></i><b>2</b> .RData e .Rhistory</a><ul>
<li class="chapter" data-level="2.1" data-path="rdata-rhistory.html"><a href="rdata-rhistory.html#por-que-desistir"><i class="fa fa-check"></i><b>2.1</b> Por que desistir</a></li>
<li class="chapter" data-level="2.2" data-path="rdata-rhistory.html"><a href="rdata-rhistory.html#como-desativar"><i class="fa fa-check"></i><b>2.2</b> Como desativar</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="rproj-dir.html"><a href="rproj-dir.html"><i class="fa fa-check"></i><b>3</b> Rproj e diretórios</a><ul>
<li class="chapter" data-level="3.1" data-path="rproj-dir.html"><a href="rproj-dir.html#diretório-de-trabalho"><i class="fa fa-check"></i><b>3.1</b> Diretório de trabalho</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="git-github.html"><a href="git-github.html"><i class="fa fa-check"></i><b>4</b> Git e GitHub</a></li>
<li class="chapter" data-level="5" data-path="funcoes-deps.html"><a href="funcoes-deps.html"><i class="fa fa-check"></i><b>5</b> Funções e dependências</a><ul>
<li class="chapter" data-level="5.1" data-path="funcoes-deps.html"><a href="funcoes-deps.html#quatro-pontos"><i class="fa fa-check"></i><b>5.1</b> Quatro-pontos</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="pacotes.html"><a href="pacotes.html"><i class="fa fa-check"></i><b>6</b> Pacotes</a><ul>
<li class="chapter" data-level="6.1" data-path="pacotes.html"><a href="pacotes.html#documentação"><i class="fa fa-check"></i><b>6.1</b> Documentação</a></li>
<li class="chapter" data-level="6.2" data-path="pacotes.html"><a href="pacotes.html#imports"><i class="fa fa-check"></i><b>6.2</b> Imports</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-data-raw.html"><a href="data-data-raw.html"><i class="fa fa-check"></i><b>7</b> Data e data-raw</a><ul>
<li class="chapter" data-level="7.1" data-path="data-data-raw.html"><a href="data-data-raw.html#documentação-1"><i class="fa fa-check"></i><b>7.1</b> Documentação</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="testes.html"><a href="testes.html"><i class="fa fa-check"></i><b>8</b> Testes automatizados</a></li>
<li class="chapter" data-level="9" data-path="versoesReleases.html"><a href="versoesReleases.html"><i class="fa fa-check"></i><b>9</b> Versões e releases</a><ul>
<li class="chapter" data-level="9.1" data-path="versoesReleases.html"><a href="versoesReleases.html#versionamento-semântico"><i class="fa fa-check"></i><b>9.1</b> Versionamento semântico</a></li>
<li class="chapter" data-level="9.2" data-path="versoesReleases.html"><a href="versoesReleases.html#releases"><i class="fa fa-check"></i><b>9.2</b> Releases</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">O Zen do R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="versoesReleases" class="section level1">
<h1><span class="header-section-number">9</span> Versões e releases</h1>
<p>A maior parte dos softwares que utilizamos no dia-a-dia possuem versões, até
mesmo aqueles que não costumamos associar com esse tipo de prática. Sistemas
operacionais, como Windows 10 e iOS 13 , têm as versões embutidas em seus
próprios nomes, enquanto muitos aplicativos, como WhatsApp 2.20.22, só exibem
esse tipo de informação no fundo da página de configurações.</p>
<p>Pacotes do R também possuem versões. Ao executar o comando <code>update.packages()</code>
(inclusive faça isso agora caso você nunca o tenha feito), o R é forçado a
procurar por versões mais recentes dos pacotes instalados na sua máquina. É
importante deixar claro que “versão” não é nada mais que o identificador de uma
atualização do software; se eu mudar uma linha do código do meu pacote e
atualizar esse fonte no GitHub, pode-se dizer que criei uma nova versão do meu
pacote.</p>
<p>Mas por que marcar e dar nomes a essas atualizações? É bastante mais fácil
simplesmente continuar programando e exigir que seus usuários baixem a versão
mais recente do seu código. Essa prática, entretanto, é ruim para o usuário e
para o programador.</p>
<p>Você, como programador, quer poder fazer alterações no seu código que não
necessariamente estão prontas para o público em geral. Erros acontecem e, muitas
vezes, é preciso fazer uma série de modificações antes que o pacote volte a ter
certa estabilidade. Por outro lado, o usuário também só quer atualizar seu
pacote quando algo suficientemente diferente estiver disponível (sejam correções
de erros, sejam novas funcionalidades). Além disso, caso uma nova versão do seu
código gere problemas para ele, é necessário ter uma versão estável anterior
claramente rotulada para que o usuário possa fazer o <em>downgrade</em> do pacote.</p>
<p>E justamente são esses rótulos que precisamos utilizar para ter um bom sistema
de versões nos nossos pacotes. Ao contrário de “controle de versão”, para o qual
utilizamos o Git, “versionamento semântico” é a prática de dar nomes fáceis de
entender para as versões de um projeto. Trazendo isso para termos concretos, quando este livro foi escrito, o
pacote <code>dplyr</code> estava na versão 0.8.4, o <code>ggplot2</code> estava na 3.2.1 e o <code>shiny</code> na 1.4.0.</p>
<div id="versionamento-semântico" class="section level2">
<h2><span class="header-section-number">9.1</span> Versionamento semântico</h2>
<p>Em teoria, existe um <a href="https://semver.org/">padrão ouro</a> para a nomenclatura de
versões de um software. Alguns dos seus preceitos, como o uso de 3 números
inteiros não-negativos separados por pontos, são extremamente valiosos, enquanto
outros nem sempre são seguidos ao pé da letra. Aqui tratamos do protocolo
padronizado, mas apenas você pode determinar quanto dele o seu esquema de
nomenclatura seguirá.</p>
<p>Uma versão é denotada pela forma X.Y.Z, onde:</p>
<ul>
<li>X é a versão maior (denominada <em>major</em>);</li>
<li>Y é a versão menor (denominada <em>minor</em>) e</li>
<li>Z é a versão do conserto (denominada <em>patch</em>).</li>
</ul>
<p>Um patch não passa de uma versão atualizada na qual apenas bugs foram
corrigidos; nenhuma funcionalidade pode ser alterada e qualquer código escrito
utilizando a versão sem o patch deve continuar funcionando. Quando alguma nova
funcionalidade é introduzida ao programa, mas ele continua sendo
retrocompatível (ou seja, compatível com as suas versões anteriores), deve ser
incrementada a versão minor. Por fim, se for introduzida alguma mudança que
quebra a retrocompatibilidade, deve ser incrementada a versão major. É
importante dizer também que, depois de lançada, uma versão <strong>nunca</strong> deverá ser
alterada, pois isso confundirá os usuários da mesma.</p>
<p>Alguns pontos do versionamento semântico não são seguidos sempre, mas podem ser
úteis. Por exemplo, o patch pode ser omitido se ele for 0, a major 0 normalmente
é reservada para software em fase de testes (o <code>dplyr</code>, portanto, não segue essa
regra) e às vezes sufixos em texto podem ser adicionados (como “-alpha”,
“-beta”, etc.).</p>
<p>Para propósitos ilustrativos, imaginemos um pacote chamado <code>pacotr</code> que possui
apenas uma função com protótipo <code>f(x, y, z = TRUE)</code>. Um caminho imaginário para
seu desenvolvimento pode ser o seguinte:</p>
<ul>
<li><p>Versão 0.1.0: a primeira versão com código do pacote contém uma função
<code>f(x, y)</code>;</p></li>
<li><p>Versão 0.1.1: um bug é consertado em <code>f(x, y)</code>;</p></li>
<li><p>Versão 0.1.2: mais um bug é consertado em <code>f(x, y)</code>;</p></li>
<li><p>Versão 1.0.0: o pacote sai do beta quando a função ganha um novo argumento
<code>z</code>, agora necessário para o seu funcionamento, e vira <code>f(x, y, z)</code>;</p></li>
<li><p>Versão 1.0.1: um bug é consertado em <code>f(x, y, z)</code>;</p></li>
<li><p>Versão 1.1.0: o argumento <code>z</code> agora tem um valor padrão, transformando a
função em <code>f(x, y, z = FALSE)</code>;</p></li>
<li><p>Versão 2.0.0: o argumento <code>z</code> muda seu valor padrão, quebrando qualquer código
escrito utilizando a versão 1.x.x, se tornando <code>f(x, y, z = TRUE)</code></p></li>
</ul>
<p>Utilizando o exemplo acima sem perda de generalidade, entre qualquer dois passos
subsequentes haveriam versões denominadas de desenvolvimento, como por exemplo
0.1.1.9000, 1.0.0.9000 e assim por diante. Isso não está no padrão ouro do
versionamento semântico, mas é comumente utilizado em programas de R.</p>
<p>Uma versão de desenvolvimento é qualquer “subversão” que não deveria ser
utilizada pelo usuário final; qualquer commit entre patches, minors ou majors é
uma versão de desenvolvimento. Por convenção, a primeira versão de
desenvolvimento é marcada como 9000, podendo chegar até 9999. Alguns
programadores incrementam esse número a cada commit realizado, mas é mais comum
manter o 9000 até que o código esteja pronto para se tornar um verdadeiro patch,
minor ou major.</p>
<p>Na prática, é muito simples trabalhar com versões. Assim que um novo pacote é
criado através de <code>usethis::create_package()</code>, o arquivo <code>DESCRIPTION</code> tem a
seguinte cara:</p>
<pre><code>Package: demo
Title: What the Package Does (One Line, Title Case)
Version: 0.0.0.9000
Authors@R: 
    person(given = &quot;First&quot;,
           family = &quot;Last&quot;,
           role = c(&quot;aut&quot;, &quot;cre&quot;),
           email = &quot;first.last@example.com&quot;,
           comment = c(ORCID = &quot;YOUR-ORCID-ID&quot;))
Description: What the package does (one paragraph).
License: What license it uses
Encoding: UTF-8
LazyData: true</code></pre>
<p>Note como o campo <em>Version</em> já está populado com a primeira versão possível para
um pacote: 0.0.0.9000. Depois de alguns commits, se acharmos que o código está
preparado para a primeira minor, utilizamos:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="versoesReleases.html#cb26-1"></a>usethis<span class="op">::</span><span class="kw">use_version</span>(<span class="st">&quot;minor&quot;</span>)</span>
<span id="cb26-2"><a href="versoesReleases.html#cb26-2"></a><span class="co">#&gt; ✔ Setting Version field in DESCRIPTION to &#39;0.1.0&#39;</span></span></code></pre></div>
<p>A segunda linha já deixa claro que agora o arquivo <code>DESCRIPTION</code> contém uma
linha <code>Version: 0.1.0</code> (note como a versão de desenvolvimento é removida
automaticamente). <strong>Mas atenção</strong>, antes de fazer qualquer outra alteração no
pacote, você deve se certificar de que esta alteração receberá um commit só para
ela. Atualmente o <code>usethis</code> faz isso automaticamente.</p>
<p>O <strong>primeiro</strong> commit após a alteração da versão deve trazer o pacote de volta
para o estado de desenvolvimento. Ou seja, deve existir um único commit no qual
o pacote é considerado estável para cada sequência de commits de
desenvolvimento.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="versoesReleases.html#cb27-1"></a>usethis<span class="op">::</span><span class="kw">use_dev_version</span>()</span>
<span id="cb27-2"><a href="versoesReleases.html#cb27-2"></a><span class="co">#&gt; ✔ Setting Version field in DESCRIPTION to &#39;0.1.0.9000&#39;</span></span></code></pre></div>
<p>Depois que o pacote voltar para desenvolvimento, a programação pode continuar
desimpedida. Por completude, <code>usethis::use_version()</code> pode ser utilizada para
qualquer versão cheia:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="versoesReleases.html#cb28-1"></a>usethis<span class="op">::</span><span class="kw">use_version</span>(<span class="st">&quot;patch&quot;</span>)</span>
<span id="cb28-2"><a href="versoesReleases.html#cb28-2"></a><span class="co">#&gt; ✔ Setting Version field in DESCRIPTION to &#39;0.1.1&#39;</span></span>
<span id="cb28-3"><a href="versoesReleases.html#cb28-3"></a></span>
<span id="cb28-4"><a href="versoesReleases.html#cb28-4"></a>usethis<span class="op">::</span><span class="kw">use_dev_version</span>()</span>
<span id="cb28-5"><a href="versoesReleases.html#cb28-5"></a><span class="co">#&gt; ✔ Setting Version field in DESCRIPTION to &#39;0.1.1.9000&#39;</span></span>
<span id="cb28-6"><a href="versoesReleases.html#cb28-6"></a></span>
<span id="cb28-7"><a href="versoesReleases.html#cb28-7"></a>usethis<span class="op">::</span><span class="kw">use_version</span>(<span class="st">&quot;major&quot;</span>)</span>
<span id="cb28-8"><a href="versoesReleases.html#cb28-8"></a><span class="co">#&gt; ✔ Setting Version field in DESCRIPTION to &#39;1.0.0&#39;</span></span></code></pre></div>
</div>
<div id="releases" class="section level2">
<h2><span class="header-section-number">9.2</span> Releases</h2>
<p>Uma parte interessante do processo de versionamento é que o GitHub permite
marcar commits específicos como estáveis e atribuir um rótulo aos mesmos. No
fundo isso não passa de um versionamento semântico integrado ao site.</p>
<p>Como exemplo, podemos ver a aba “Releases” do pacote <code>decryptr</code>:</p>
<p><img src="static/versoes-releases/ver.png" width="70%" style="display: block; margin: auto;" /></p>
<p>É bom fazer esse tipo de versionamento externo porque os usuários passam a ter
um lugar de fácil acesso com o código-fonte de absolutamente todas as versões do
seu pacote. Além disso, a função <code>devtools::install_github()</code> é capaz de
utilizar esses releases como indicador de qual versão de um pacote deve ser
baixada.</p>
<p>Para criar releases de um pacote seu, antes você deve dar push no commit da
versão atual (depois de <code>usethis::use_version()</code> e antes de
<code>usethis::use_dev_version()</code>), pois assim estará pública no GitHub exatamente a
versão do seu pacote que deve ser baixada pelos usuários. Depois basta ir para
a aba das releases e clicar em <strong>Draft a new release</strong>. Preencha os campos
correspondentes e publique a versão.</p>
<p><img src="static/versoes-releases/tag.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Uma forma eficiente de manter todas as alterações realizadas no pacote de forma
organizada é com um arquivo <code>NEWS</code>. Ele pode ser criado com
<code>usethis::use_news_md()</code> e criar um novo título para cada versão. Observe como
<a href="https://github.com/tidyverse/ggplot2/blob/master/NEWS.md">esse arquivo</a> é
utilizado no <code>ggplot2</code>.</p>

</div>
</div>












            </section>

          </div>
        </div>
      </div>
<a href="testes.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/curso-r/zen-do-r/edit/master/versoes-releases.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
